{% extends 'AnalyzerDir/base.html' %}
{% load static %}
{% load bootstrap3 %}
{% block page-header %} Analyzer {% endblock %}
{% block page-sub-header %} Analyzer Analytics {% endblock %}
{% block cssimport %}

    <!-- NProgress -->
    <link href="{% static 'vendor/nprogress/nprogress.css' %}" rel="stylesheet">

    <!-- bootstrap-progressbar -->
    <link href="{% static 'vendor/bootstrap-progressbar/css/bootstrap-progressbar-3.3.4.min.css' %}" rel="stylesheet">


    <!-- Datatables -->
    <link href="{% static 'vendor/datatables.net-bs/css/dataTables.bootstrap.min.css' %}" rel="stylesheet">
    <link href="{% static 'vendor/datatables.net-buttons-bs/css/buttons.bootstrap.min.css' %}" rel="stylesheet">
    <link href="{% static 'vendor/datatables.net-fixedheader-bs/css/fixedHeader.bootstrap.min.css' %}" rel="stylesheet">
    <link href="{% static 'vendor/datatables.net-responsive-bs/css/responsive.bootstrap.min.css' %}" rel="stylesheet">
    <link href="{% static 'vendor/datatables.net-scroller-bs/css/scroller.bootstrap.min.css' %}" rel="stylesheet">


    <!-- select bootstrap -->
    <!--https://github.com/silviomoreto/bootstrap-select-->
    <link href="{% static 'vendor/bootstrap-select-master/dist/css/bootstrap-select.css' %}" rel="stylesheet">
    <link href="{% static 'vendor/bootstrap-select-master/dist/css/bootstrap-select.min.css' %}" rel="stylesheet">


    <!-- iCheck -->
    <link href="{% static 'vendor/iCheck/skins/flat/green.css' %}" rel="stylesheet">

{% endblock %}


{% bootstrap_css %}
{% bootstrap_javascript %}
{% block bodycontent %}
    <br/><br/><br/><br/>

    <!-- Controller panel -->
    <div class="controller">
        <!-- Analyzer Controller -->
        <div class="col-md-6 col-sm-6 col-xs-6" style="overflow:auto;">
            <div class="x_panel">
                <div class="x_title">
                    <h2> Analyzer Controller
                        <small>Pre Process/Data Analysis/Post Process</small>
                    </h2>
                    <ul class="nav navbar-right panel_toolbox">
                        <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                               aria-expanded="false"><i class="fa fa-wrench"></i></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="#">Settings 1</a>
                                </li>
                                <li><a href="#">Settings 2</a>
                                </li>
                            </ul>
                        </li>
                        <li><a class="close-link"><i class="fa fa-close"></i></a>
                        </li>
                    </ul>
                    <div class="clearfix"></div>
                </div>

                <div class="x_content">
                    <p class="text-muted font-13 m-b-30">
                        Whole projects lists.
                    </p>


                    {#                  <input type="text" id="ajax-jobsubmitter" placeholder="jobsubmitter"/>#}




{#                    <input type="text" id="ajax-x" placeholder="test_x"/>#}
{#                    <input type="text" id="ajax-y" placeholder="test_y"/>#}
{#                    <input type="text" id="ajax-status" placeholder="status"/>#}
{#                    <input type="text" id="ajax-priority" placeholder="priority"/>#}

                    <!-- TODO: validation is not used. -->
                    <div id="form-div">
                        <form id="datafile-upload-form" action="" method="post" enctype="multipart/form-data">
                            {% csrf_token %}
                            <table>
                                {{ datafile_form.as_table }}
                                {{ job_form.as_table }}
                                <tr>
                                    <th>JobName: </th>
                                    <td><input type="text" id="ajax-jobname" placeholder="jobname"/></td>
                                </tr>
                                <tr>
                                <th>
                                    Priority:
                                </th>
                                    <td>
                                        <select class="" name="Job Priority">
                                            <optgroup label="priority">
                                                <option value="1">1</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                            </optgroup>
                                        </select>
                                    </td>
                                </tr>
                                <!-- Solver Select -->
                                <tr>
                                <th>
                                    Solver:
                                </th>
                                    <td>
                                        <select class="Image-Solver" name="image-solver-name">
                                            <optgroup label="image-solver">
                                                <option value="Testing">Testing</option>
                                                <option value="DeepDream">DeepDream</option>
                                                <option value="StyleTransfer">StyleTransfer</option>
                                            </optgroup>
                                        </select>
                                    </td>
                                </tr>
                            </table>
                            <input type="submit" class="btn btn-primary fa fa-upload" value="submit" id="req"/>
                        </form>
                    </div>
                    <p class="answer-console col-md-12 col-sm-12 col-xs-12" id="anwser" style="
                    height: 200px;
                    white-space: nowrap;
                    overflow: scroll;
                    background-color:black;
                    color: seashell;">Hello!</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Analyzer Task -->
    <div class="col-md-6 col-sm-6 col-xs-6">
        <div class="x_panel">
            <div class="x_title">
                <h2> Task List
                    <small> for whole</small>
                </h2>
                <ul class="nav navbar-right panel_toolbox">
                    <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                           aria-expanded="false"><i class="fa fa-wrench"></i></a>
                        <ul class="dropdown-menu" role="menu">
                            <li><a href="#">Settings 1</a>
                            </li>
                            <li><a href="#">Settings 2</a>
                            </li>
                        </ul>
                    </li>
                    <li><a class="close-link"><i class="fa fa-close"></i></a>
                    </li>
                </ul>
                <div class="clearfix"></div>
            </div>
            <div class="x_content">
                <div class="">
                  <ul class="to_do">
                    {% for job in jobs %}
                      <li>
                      <p>
                        <input type="checkbox" class="flat"> {{ job.job_name }} </p>
                    </li>
                    {% endfor %}
                  </ul>
                </div>
                <!-- task-table-wrapper-->
                <div class="task-table-wrapper">
                  <table id="task-table1" class="table table-striped table-bordered bulk_action datatable-checkbox">
                    <thead>
                      <tr>
                        <th>&nbsp;&nbsp;<input type="checkbox" id="check-all" class="flat"></th>
                        <th>priority</th>
                        <th style="display:none;"></th>
                        <th>task name</th>
                        <th>task submitter</th>
                      </tr>
                    </thead>
                    <tbody>
                      {% for job in jobs %}
                      <tr>
                        <td><input type="checkbox" class="flat" name="table_records"></td>
                        <td>{{ job.job_priority }}</td>
                        <td class="job-pk" style="display:none;">{{job.pk}}</td>
                        <td>{{ job.job_name }}</td>
                        <td>{{ job.job_submitter }} </td>
                      </tr>
                      {% endfor %}
                    </tbody>
                  </table>
                  <div>
                    <button class="btn btn-danger btn-sm btn-job-delete" data-toggle="modal"
                            data-target="#job-delete-confirm-modal">DELET</button>
                  </div>
                </div>
                <!-- task-table-wrapper ends -->
            </div>

            <!-- delete confirmation modal -->
            <div class="container">
              <!-- Task Post Modal -->
              <div class="modal fade" id="job-delete-confirm-modal" role="dialog">
                <div class="modal-dialog">
                  <!-- Modal content-->
                  <div class="modal-content">
                    <div class="modal-header">
                      <button type="button" class="close" data-dismiss="modal">&times;</button>
                      <h4 class="modal-title">Task delete confirmation</h4>
                    </div>
                    <div class="modal-body">
                      <p> Are you sure to delete ?</p>
                    </div>
                    <div class="modal-footer">
                      <button type="submit" id="delete_yes_button1" class="btn btn-default delete_yes_button"
                              data-dismiss="modal" name="delete_job" value="1">Yes</button>
                      <button type="button" class="btn btn-default" data-dismiss="modal">No</button>
                    </div>
                  </div>

                </div>
              </div>
            </div>

        </div>
    </div>



    <div class="clearfix"></div>

    <!-- ML Report -->
    <div class="col-md-12 col-sm-12 col-xs-12" style="overflow:auto;">
        <div class="x_panel">
            <div class="x_title">
                <h2> DL Analysis Report </h2>
                <ul class="nav navbar-right panel_toolbox">
                    <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                           aria-expanded="false"><i class="fa fa-wrench"></i></a>
                        <ul class="dropdown-menu" role="menu">
                            <li><a href="#">Settings 1</a>
                            </li>
                            <li><a href="#">Settings 2</a>
                            </li>
                        </ul>
                    </li>
                    <li><a class="close-link"><i class="fa fa-close"></i></a>
                    </li>
                </ul>
                <div class="clearfix"></div>
            </div>
            <div class="x_content">


                <div class="" role="tabpanel" data-example-id="togglable-tabs">
                    <ul id="myTab" class="nav nav-tabs bar_tabs" role="tablist">
                        <li role="presentation" class="active"><a href="#tab_content1" id="home-tab" role="tab"
                                                                  data-toggle="tab" aria-expanded="true">Prediction
                            Results</a>
                        </li>
                        <li role="presentation" class=""><a href="#tab_content2" role="tab" id="profile-tab"
                                                            data-toggle="tab" aria-expanded="false">Feature
                            Engineering</a>
                        </li>
                    </ul>
                    <div class="clearfix"></div>
                    <div id="myTabContent" class="tab-content">
                        <!-- panel 1 -->
                        <div role="tabpanel" class="tab-pane fade active in" id="tab_content1"
                             aria-labelledby="home-tab">
                            <p>Raw denim you probably haven't heard of them jean shorts Austin. Nesciunt tofu stumptown
                                aliqua, retro synth master cleanse. Mustache cliche tempor, williamsburg carles vegan
                                helvetica. Reprehenderit butcher retro keffiyeh dreamcatcher
                                synth. Cosby sweater eu banh mi, qui irure terr.</p>
                            <!-- Prediction Results panel -->
                            <div class="x_panel">
                                <div class="x_title">
                                    <h2>Prediction Results</h2>
                                    <ul class="nav navbar-right panel_toolbox">
                                        <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                                        </li>
                                        <li class="dropdown">
                                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                                               aria-expanded="false"><i class="fa fa-wrench"></i></a>
                                            <ul class="dropdown-menu" role="menu">
                                                <li><a href="#">Settings 1</a>
                                                </li>
                                                <li><a href="#">Settings 2</a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li><a class="close-link"><i class="fa fa-close"></i></a>
                                        </li>
                                    </ul>
                                    <div class="clearfix"></div>
                                </div>
                                <div class="x_content">

                                    <p>Simple table with project listing with progress and editing options</p>
                                    <!-- ml report plot canvas -->
                                    <div id="anwser-ml-report-1" style="max-width: 100%">
                                    </div>
                                    <!-- ml report plot canvas end -->
                                </div>
                            </div>
                            <!-- Prediction Results panel end -->
                        </div>
                        <!-- panel 2 -->
                        <div role="tabpanel" class="tab-pane fade" id="tab_content2" aria-labelledby="profile-tab">
                            <!-- ml report plot canvas -->
                            <div id="anwser-ml-report" style="height: 400px;">
                                {#<iframe id="anwser-ml-report-quiver" src="http://localhost:7000" style="width: 100%; height: 100%;" onload="alert('error!');"></iframe>#}
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>



{% endblock %}
{% block jsimport %}


    <!-- Cookie -->
    <script src="{% static 'js/jquery.cookie.js' %}"></script>
    <!-- FastClick -->
    <script src="{% static 'vendor/fastclick/lib/fastclick.js' %}"></script>
    <!-- NProgress -->
    <script src="{% static 'vendor/nprogress/nprogress.js' %}"></script>
    <!-- bootstrap-progressbar -->
    <script src="{% static 'vendor/bootstrap-progressbar/bootstrap-progressbar.min.js' %}"></script>

    <!-- iCheck -->
    <script src="{% static 'vendor/iCheck/icheck.min.js' %}"></script>

    <!-- Custom Theme Scripts -->
    <script src="{% static 'build/js/custom.js' %}"></script>


    <!-- Check Whether user intended to close the x_panel -->
    <script>
        $('i[class="fa fa-close"]').on('click', function (e) {
            var r = confirm("Press a button");
            if (r == true) {
                x = "";
            } else {
                x = "You pressed Cancel!";
            }
        });
    </script>

    <script src="{% static 'vendor/bootstrap-select-master/dist/js/bootstrap-select.min.js' %}"></script>



    <!-- Ajax request -->
    <script>
        $(document).ready(function () {
            function worker() {
            }

            $('#req').on('click', function () {
                var csrftoken = $.cookie('csrftoken');

                function csrfSafeMethod(method) {
                    // these HTTP methods do not require CSRF protection
                    return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
                }

                $.ajaxSetup({
                    beforeSend: function (xhr, settings) {
                        if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                            xhr.setRequestHeader("X-CSRFToken", csrftoken);
                            xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
                        }
                    }
                });

                var x = $('#ajax-x').val();
                var y = $('#ajax-y').val();
                var styler_option = $('.Image-Solver').val();
                alert('aled!!!!' + styler_option);

                $.ajax({
                    url: '/analyzer/image-analysis/',
                    dataType: 'json',
                    method: 'post',
                    data: {'x': x, 'y': y, 'styler_option': styler_option},
                    success: function (data) {
                        $('#anwser').append("<br/>");
                        $('#anwser').append(data.consoles);
                        $('#anwser-ml-report-1').append(data.plots);
                    },
                    complete: function (data) {
                        //setTimeout(worker, 5000);
                    },
                });
            });
        });


    </script>

    <!-- iframe setTimeout -->
    <script>
    </script>

{% endblock %}